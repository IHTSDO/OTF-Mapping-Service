<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<!--[if IE]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
<script>
	jQuery(function($) {
		$('#widget').height(550).split({
			orientation : 'horizontal',
			position : '70%'
		});
		$('#widgetSplitter').split({
			orientation : 'horizontal',
			position : '65%'
		});
		$('#recordsSplitter').split({
			orientation : 'vertical',
			position : '50%'
		});
		$('#feedbackSplitter').split({
			orientation : 'vertical',
			position : '50%'
		});
	});
</script>


</head>
<body>

	<div id="widget">
		<div id="widgetSplitter">
			<div id="recordsSplitter">
				<div class="a">
					<!--  ENTRIES PANEL -->
					<accordion> <accordion-group is-open="isEntriesOpen">
					<accordion-heading> Entries:
					{{record1.displayName}}<i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isEntriesOpen, 'glyphicon-chevron-right': !isEntriesOpen}"></i>
					</accordion-heading>

					<div ng-show="project.groupStructure == true">

						<accordion close-others="false">

						<div ui-sortable ng-model="groups1">

							<!--  first-level accordion groups -->
							<accordion-group ng-repeat="group in groups1" is-open="true">

							<accordion-heading> <span
								style="text-align: left;">Map Group </span> </accordion-heading>



							<div ui-sortable ng-model="entries1[group]">
								<p ng-repeat="entry in entries1[group] track by entry.localId">

									<span ng-show="entry.targetId != null && entry.targetId != ''">
										<span
										ng-show="project.ruleBased == true">{{entry.ruleSummary}}
										</span>
										{{entry.targetId}} {{entry.targetName}}
									</span> 
									
									<span
										ng-show="entry.mapAdvice.length > 0"> 
										<span
										class="dropdown"> <a class="dropdown-toggle"> <img
												src="img/dialog-question.png" alt="question icon">
										</a> 
											<span class="dropdown-menu term-browser-dropdown-menu">
												<strong>Advice</strong> <!-- need to revisit why the ng-repeat="advice in entry.mapAdvice" is not working  -->
												{{entry.mapAdvice[0].detail}}<br>
												{{entry.mapAdvice[1].detail}} {{entry.mapAdvice[2].detail}}
											</span>

										</span>
									</span> 
									<br> <br> <span class="alert alert-warning"
										ng-show="entry.mapRelation != null">
										{{entry.mapRelation.name}} </span>
							</div>
							<!--  end sortable entries --> </accordion-group>
							<!--  end Group accordion group -->

						</div>
						<!--  end sortable groups --> </accordion>
						<!--  end group accordion -->
					</div>

					<!--  for no group structure in project -->
					<div ng-show="project.groupStructure == false"">

						<div ui-sortable ng-model="entries1">
							<p ng-repeat="entry in entries1">
								<span ng-show="entry.targetId != null && entry.targetId != ''">
									<span ng-show="project.ruleBased == 'true'">[{{entry.ruleSummary}}]</span>
									{{entry.targetId}} {{entry.targetName}}
								</span> <span ng-show="entry.targetId == null || entry.targetId === ''">{{getEntrySummary(entry)}}</span>
							</p>
						</div>
					</div>

					</accordion-group> <!--  end entries accordion group --> </accordion>
					<!--  end entries accordion -->

					<!--  PRINCIPLES PANEL -->
					<accordion ng-show="record1.mapPrinciple.length != 0">
					<accordion-group is-open="isPrinciplesOpen"> <accordion-heading>
					Principles <i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isPrinciplesOpen, 'glyphicon-chevron-right': !isPrinciplesOpen}"></i>
					</accordion-heading>

					<div ng-repeat="principle in record1.mapPrinciple">
						{{principle.principleId}}: {{principle.name}}</div>
					</accordion-group> </accordion>

					<!--  NOTES PANEL -->
					<accordion ng-show="record1.mapNote.length != 0"> <accordion-group
						is-open="isNotesOpen"> <accordion-heading>
					Notes <i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isNotesOpen, 'glyphicon-chevron-right': !isNotesOpen}"></i>
					</accordion-heading>
					<div ng-repeat="note in record1.mapNote"
						ng-bind-html="to_trusted(note.note)"></div>
					</accordion-group> </accordion>
					
					<button class="btn btn-sm btn-primary" style="margin: 4px"
						ng-click="populateMapRecord(record1)">Start here</button>
					


				</div>

				<div class="b">
					<!--  ENTRIES PANEL -->
					<accordion> <accordion-group is-open="isEntriesOpen">
					<accordion-heading> Entries:
					{{record2.displayName}}<i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isEntriesOpen, 'glyphicon-chevron-right': !isEntriesOpen}"></i>
					</accordion-heading>

					<div ng-show="project.groupStructure == true">

						<accordion close-others="false">

						<div ui-sortable ng-model="groups2">

							<!--  first-level accordion groups -->
							<accordion-group ng-repeat="group in groups2" is-open="true">

							<accordion-heading> <span
								style="text-align: left;">Map Group </span> </accordion-heading>

							<div ui-sortable ng-model="entries2[group]">
								<p ng-repeat="entry in entries2[group] track by entry.localId">

								

									<span ng-show="entry.targetId != null && entry.targetId != ''">
										<span
										ng-show="project.ruleBased == true">{{entry.ruleSummary}}
										</span>
										{{entry.targetId}} {{entry.targetName}}
									</span> 
									
									<span
										ng-show="entry.targetId == null || entry.targetId === ''">{{getEntrySummary(entry)}}
									</span>

									<span ng-show="entry.mapAdvice.length > 0"> 
										<span
										class="dropdown"> <a class="dropdown-toggle"> <img
												src="img/dialog-question.png" alt="question icon"></a> 
										
											<span class="dropdown-menu term-browser-dropdown-menu">
												<strong>Advice</strong> <!-- need to revisit why the ng-repeat="advice in entry.mapAdvice" is not working  -->
												{{entry.mapAdvice[0].detail}} {{entry.mapAdvice[1].detail}}
												{{entry.mapAdvice[2].detail}}
											</span>
										</span>
									</span> <br> <br> 
									<span class="alert alert-warning"
										ng-show="entry.mapRelation != null">
											{{entry.mapRelation.name}} 
									</span>
									

								</p>
							</div>
							<!--  end sortable entries --> </accordion-group>
							<!--  end Group accordion group -->

						</div>
						<!--  end sortable groups --> </accordion>
						<!--  end group accordion -->
					</div>

					<!--  for no group structure in project -->
					<div ng-show="project.groupStructure == false"">

						<div ui-sortable ng-model="entries2">
							<p ng-repeat="entry in entries2">
								<span ng-show="entry.targetId != null && entry.targetId != ''">
									<span ng-show="project.ruleBased == 'true'">[{{entry.ruleSummary}}]</span>
									{{entry.targetId}} {{entry.targetName}}
								</span> <span ng-show="entry.targetId == null || entry.targetId === ''">{{getEntrySummary(entry)}}</span>

							</p>
						</div>
					</div>

					</accordion-group> <!--  end entries accordion group --> </accordion>
					<!--  end entries accordion -->

					<!--  PRINCIPLES PANEL -->
					<accordion ng-show="record2.mapPrinciple.length != 0">
					<accordion-group is-open="isPrinciplesOpen"> <accordion-heading>
					Principles <i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isPrinciplesOpen, 'glyphicon-chevron-right': !isPrinciplesOpen}"></i>
					</accordion-heading>

					<div ng-repeat="principle in record2.mapPrinciple">
						{{principle.principleId}}: {{principle.name}}</div>
					</accordion-group> </accordion>

					<!--  NOTES PANEL -->
					<accordion ng-show="record2.mapNote.length != 0"> <accordion-group
						is-open="isNotesOpen"> <accordion-heading>
					Notes <i class="pull-right glyphicon"
						ng-class="{'glyphicon-chevron-down': isNotesOpen, 'glyphicon-chevron-right': !isNotesOpen}"></i>
					</accordion-heading>
					<div ng-repeat="note in record2.mapNote"
						ng-bind-html="to_trusted(note.note)"></div>
					</accordion-group> </accordion>

					<button class="btn btn-sm btn-primary" style="margin: 4px"
						ng-click="populateMapRecord(record2)">Start here</button>

				</div>
				<!--  end class b -->

			</div> <!--  end recordSplitter -->

      <div id="feedbackSplitter">
        <div class="a">

          <div ng-show="conversation1.feedback.length > 0">
            <div ng-repeat="feedback in conversation1.feedback">
              <div class="alert alert-warning" disabled>
                [By {{feedback.sender.name}}
                to <span ng-repeat="recipient in feedback.recipients">
                         {{recipient.name}}</span>
                on {{feedback.timestamp | date:'MM-dd-yyyy HH:mm'}}]
                <div ng-show="feedback.mapError != 'None'"
                  style="padding-left: 20px;"
                  ng-bind-html="to_trusted(feedback.mapError)"></div>
                <div style="padding-left: 20px;"
                  ng-bind-html="to_trusted(feedback.message)"></div>
              </div>
            </div>
            <hr>
          </div>


          <form style="margin-top: 8px; margin-left: 4px;">
            <table>
              <tr>
                  <form method="post">
                  <textarea id="tinymce-feedback1" ui-tinymce="tinymceOptions" ng-model="feedbackComment1"></textarea>
                  </form>
              </tr>
              <tr>
                <td>Error Message:&nbsp;</td>
                <td><select ng-model="selectedErrorMessage1" style="margin: 4px"
                  ng-options="msg as msg.displayName for msg in errorMessages track by msg.displayName">
                </select></td>
              </tr>
            </table>
            <div>
              <button class="btn btn-sm btn-primary" style="margin: 4px"
                ng-click="submitNewFeedback(record1, selectedErrorMessage1, feedbackComment1); feedbackComment1 = ''; selectedErrorMessage1 = errorMessages[0];">Submit
                feedback</button>
            </div>
          </form>
        </div>
        <div class="b">
        
          <div ng-show="conversation2.feedback.length > 0">
            <div ng-repeat="feedback in conversation2.feedback">
              <div class="alert alert-warning" disabled>
                [By {{feedback.sender.name}}
                to <span ng-repeat="recipient in feedback.recipients">
                         {{recipient.name}}</span>
                on {{feedback.timestamp | date:'MM-dd-yyyy HH:mm'}}]
                <div ng-show="feedback.mapError != 'None'"
                  style="padding-left: 20px;"
                  ng-bind-html="to_trusted(feedback.mapError)"></div>
                <div style="padding-left: 20px;"
                  ng-bind-html="to_trusted(feedback.message)"></div>
              </div>
            </div>
            <hr>
          </div>
        
     

     
        
          <form style="margin-top: 8px; margin-left: 4px;">
            <table>
              <tr>
                  <form method="post">
                  <textarea id="tinymce-feedback2" ui-tinymce="tinymceOptions" ng-model="feedbackComment2"></textarea>
                  </form>
              </tr>
              <tr>
                <td>Error Message:&nbsp;<select ng-model="selectedErrorMessage2" style="margin: 4px"
                  ng-options="msg as msg.displayName for msg in errorMessages track by msg.displayName">
                </select></td>
              </tr>
            </table>
            <div>
              <button class="btn btn-sm btn-primary" style="margin: 4px"
                ng-click="submitNewFeedback(record2, selectedErrorMessage2, feedbackComment2); feedbackComment2 = ''; selectedErrorMessage2 = errorMessages[0];">Submit
                feedback</button>
            </div>
          </form>

        </div>
        <!--  end class b -->
      </div>
      <!--  end feedbackSplitter -->


    </div>
		<div id="report" ng-show="record2 != null">
			<accordion> 
				<accordion-group is-open="isGroupFeedbackOpen">
				<accordion-heading> Group Feedback<i
					class="pull-right glyphicon"
					ng-class="{'glyphicon-chevron-down': isGroupFeedbackOpen, 'glyphicon-chevron-right': !isGroupFeedbackOpen}"></i>
				</accordion-heading>
 				
                <div ng-show="leadConversation.feedback.length > 0">
                  <div ng-repeat="feedback in leadConversation.feedback">
                    <div class="alert alert-warning" disabled>
                      [By {{feedback.sender.name}}
                      to <span ng-repeat="recipient in feedback.recipients">
                         {{recipient.name}}<span ng-if="$last == false">,</span></span>
                      on {{feedback.timestamp | date:'MM-dd-yyyy HH:mm'}}]
                      <div style="padding-left: 20px;"
                        ng-bind-html="to_trusted(feedback.message)"></div>
                    </div>
                  </div>
                  <hr>
                </div>        
        
                <form method="post">
                  <textarea id="tinymce-feedback3" ui-tinymce="tinymceOptions" ng-model="groupFeedback"></textarea>
                </form>
				<button class="btn btn-sm btn-primary" style="margin: 4px"
								ng-click="submitGroupFeedback(groupFeedback)">Submit feedback</button>
		 		
                <input type="checkbox" ng-model="indicateDiscrepancyReview" ng-change="selectDiscrepancyReview(indicateDiscrepancyReview)"> Mark for Discrepancy Review						
        </accordion-group>
				<accordion-group is-open="isReportOpen">
				<accordion-heading> Conflict Report <i
					class="pull-right glyphicon"
					ng-class="{'glyphicon-chevron-down': isReportOpen, 'glyphicon-chevron-right': !isReportOpen}"></i>
				</accordion-heading>
	
				<div ng-show="validationResult.errors.length > 0">
					<h4>Errors:</h4>
					<div ng-repeat="result in validationResult.errors">{{result}}</div>
				</div>
				<div ng-show="validationResult.warnings.length > 0">
					<h4>Warnings:</h4>
					<div ng-repeat="result in validationResult.warnings">{{result}}</div>
				</div>
				</accordion-group> 
			</accordion>
		</div>
	</div>
</body>
</html>
