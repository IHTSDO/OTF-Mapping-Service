<!--  partial for displaying list of records -->
<div ng-include src="'./partials/header.html'"></div>

<p></p>

<a href="#/project/details"><h3>{{project.name}}</h3></a>
<p></p>

<p>{{errorRecords}}</p>

<p>
<form>
  <input ng-model="query"> <input type="submit" value="Search"
    ng-click="retrieveRecords(1)"> <input type="submit" value="Reset"
    ng-click="resetSearch()">
</form>


<table width="100%" class="table">
  <thead>
    <tr>
      <th style="width: 39%;"><div tooltip-placement="top"
        tooltip="Source Concept Name and Id">
        <b>Concept Name</b>
      </div></th>
      <th style="width: 4%;"><div tooltip-placement="top"
        tooltip="Group Id / Map Priority">
        <b>Grp/Prty</b>
      </div></th>
      <th style="width: 14%;" ng-show="project.ruleBased == true"><div tooltip-placement="top"
        tooltip="Map Rule">
        <b>Rule</b>
      </div></th>

      <th style="width: 42%;"><div tooltip-placement="top"
        tooltip="Target Preferred Name and Code">
        <b>Target Name</b>
      </div></th>
      <th style="width: 5%;"></th>
    </tr>
  </thead>

  <tbody ng-repeat="record in records" style="border: 2px solid #ccc;">

    <tr ng-repeat="entry in record.mapEntry" style="">

     
      <td><div>{{record.conceptName}}</div>
          <div><a href="#/record/conceptId/{{record.conceptId}}">{{record.conceptId}}</a>
      <span ng-show="record.mapNote.length > 0 && currentRole != 'Viewer'"> <span
          class="dropdown"> <a class="dropdown-toggle"> <img
              src="img/notepad.png" alt="notepad icon">
          </a> <span class="dropdown-menu project-records-dropdown-menu"> <strong>Notes</strong>
              <p></p>
              <p ng-repeat="note in record.mapNote"
                ng-bind-html="to_trusted(note.note)"></p>
          </span>
        </span>
      </span> <span ng-show="entry.mapAdvice.length > 0">
          <span class="dropdown">
            <a class="dropdown-toggle"> <img src="img/dialog-question.png"
              alt="question icon">
            </a> <span class="dropdown-menu project-records-dropdown-menu"> <strong>Advice</strong>
              <p></p>
              <p ng-repeat="advice in entry.mapAdvice"
                ng-bind-html="to_trusted(advice.detail)"></p>
            </span>
          </span>
      </span> <span ng-show="record.unmappedDescendants.length > 0"> <span
          class="dropdown"> <a class="dropdown-toggle"> <img
              src="img/warning.png" alt="question icon">
          </a>
            <ul class="dropdown-menu project-records-dropdown-menu">
              <b>Unmapped Descendants</b>
              <li ng-repeat="concept in record.unmappedDescendants"><a
                href="#/record/conceptId/{{concept.terminologyId}}">{{concept.terminologyId}}:
                  {{concept.value}}</a></li>
            </ul>
        </span>
      </span>          
       </div>   
      </td>
      <td>{{entry.mapGroup}}&nbsp;/&nbsp;{{entry.mapPriority}}</td>
      <td ng-show="project.ruleBased == true">{{entry.rule}}</td>
      <td><div>{{entry.targetName}}</div>
          <div>{{entry.targetId}}</div></td>
      <td><a
              title="Edit"
              ng-show="isEditable(record)" 
              ng-click="editRecord(record)"><i
              class="glyphicon glyphicon glyphicon-pencil"></i></a>
      </td>
    </tr>

  </tbody>
  {{nRecords}} results, page {{recordPage}} of {{numRecordPages}}
  <pagination total-items="nRecords" page="recordPage" max-size="recordsPerPage"
    class="pagination-sm" boundary-links="true" rotate="true"
    num-pages="numRecordPages" on-select-page="retrieveRecords(page)"></pagination>


</table>

<p ng-show="unmappedDescendantsPresent">
  <img src="img/warning.png" alt="Unmapped Descendant Warning"> = This
  concept has unmapped descendants.
</p>
<p ng-show="mapNotesPresent && currentRole != 'Viewer'">
  <img src="img/notepad.png" alt="Note(s) Present"> = This entry has
  notes.
</p>
<p ng-show="mapAdvicesPresent">
  <img src="img/dialog-question.png" alt="Advice(s) Present"> = This entry
  has advices.
</p>


<div ng-include src="'./partials/footer.html'"></div>



